// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id             Int              @id @default(autoincrement())
  name           String
  email          String           @unique
  height         Float?
  weight         Float?
  multiRunMember MultiRunMember[]

  @@map("user")
}

model MultiRun {
  id             Int              @id @default(autoincrement())
  roomImage      String?          @map("room_image")
  title          String
  state          RoomState
  description    String?          @db.Text
  startedAt      DateTime         @map("started_at")
  limitTime      DateTime         @map("limit_time")
  limitMember    Int              @map("limit_member")
  multiRunMember MultiRunMember[]

  @@map("multi_run")
}

model MultiRunMember {
  roomId Int
  userId Int
  runId  String?

  multiRunRoom MultiRun @relation(fields: [roomId], references: [id])
  multiRunUser User     @relation(fields: [userId], references: [id])
  @@unique([roomId, userId], name: "roomMember")
  @@map("multi_run_member")
}

model RunState {
  id       Int     @id @default(autoincrement())
  roomId   String  @map("room_id")
  userId   Int     @map("user_id")
  socketId String? @map("socket_id")

  @@map("run_state")
}

enum RoomState {
  Open
  close
}
